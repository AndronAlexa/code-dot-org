- feedback_provided = Lti::Feedback.provided?(current_user)

#lti-feedback-modal.modal.hide.fade{role: 'dialog', aria: {modal: 'true', labelledby: 'lti-feedback-modal-title'}}
  %a.close{aria: {label: t('to_close')}, role: 'button', data: {dismiss: 'modal'}, href: '#'}
    %span{aria: {hidden: 'true'}} Ã—

  = form_for Lti::Feedback.new, url: lti_v1_feedbacks_path, remote: true, html: {style: feedback_provided ? 'display: none;' : ''} do |f|
    = f.hidden_field :satisfaction_level
    .modal-header
      %h4.heading-md#lti-feedback-modal-title= t('lti.feedback.modal.title')
    .modal-body
      %fieldset
        %legend= t('lti.feedback.modal.satisfaction_level')
        - Lti::Feedback.satisfaction_levels.each_key do |satisfaction_level|
          %label.radio
            = f.radio_button :satisfaction_level, satisfaction_level, required: true
            = t(satisfaction_level, scope: %i[activerecord attributes lti/feedback satisfaction_levels])
    .modal-footer
      = f.submit t('submit')

  #provided{style: feedback_provided ? '' : 'display: none;'}
    .modal-header
      %h4.heading-md= t('lti.feedback.modal.provided.title')
    .modal-body
      %p= t('lti.feedback.modal.provided.additional_feedback')
      %br
      != t('lti.feedback.modal.provided.additional_feedback_link', url: SharedConstants::LMS_LINKS.ADDITIONAL_FEEDBACK_URL, markdown: true)
    .modal-footer
      %input{type: 'button', value: t('to_close'), data: {dismiss: 'modal'}}

  = javascript_include_tag webpack_asset_path('js/lti/v1/feedbacks/_modal.js'),
                           data: {modalSelector: JSON.dump('#lti-feedback-modal'),
                                  userKey: JSON.dump(Digest::MD5.hexdigest(current_user.id.to_s))}
